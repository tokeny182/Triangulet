<!DOCTYPE html>
<html>

<head>
  <title>TrianAI | Triangulet</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css">
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" crossorigin="anonymous" href="https://ac.blooket.com/dashclassic/assets/index-BQ9cjwWZ.css">
  <link rel="icon" type="image/x-icon" href="https://i.ibb.co/5GBHSTB/Triangulet-Game-Logo.png">

  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #222;
      color: #fff;
    }

    #chat-container {
      height: 500px;
      width: 80%;
      max-width: 1114px;
      overflow-y: auto;
      padding: 10px;
      margin-bottom: 10px;
      background-color: rgba(0, 0, 0, 0);
      margin-left: 220px;
    }

    .chat-message {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      color: #fff;
    }

    .chat-message img {
      margin-right: 10px;
      width: 30px;
      height: 30px;
    }

    .styles__infoContainer___2uI-S-camelCase {
      width: 1000px;
      padding: 15px;
      position: fixed;
      bottom: 0;
      left: 25%;
      transform: translateX(-10%);
    }

    input[type="text"] {
      width: 98%;
      padding: 5px;
      font-size: 16px;
      font-family: 'Nunito', sans-serif;
      background: rgba(0, 0, 0, 0.5);
      color: #fff;
      border: none;
      outline: none;
      border-radius: 5px;
      display: inline-block;
    }
  </style>
</head>

<body>
  <div class="styles__background___2J-JA-camelCase">
    <div class="styles__blooksBackground___3oQ7Y-camelCase" style="background-image: url('https://i.ibb.co/d7GK1cC/background.png'); animation: animatedBackground 9s linear infinite;"></div>
  </div>

  <div class="styles__topRightRow___dQvxc-camelCase">
    <div class="styles__profileContainer___CSuIE-camelCase" role="button" tabindex="0">
    <div class="styles__profileRow___cJa4E-camelCase">
      <div style="position: relative" class="styles__blookContainer___36LK2-camelCase styles__profileBlook___37mfP-camelCase">
        <img src="https://i.ibb.co/5GBHSTB/Triangulet-Game-Logo.png" id="pfpimg" draggable="false" class="styles__blook___1R6So-camelCase">
      </div>
      <span style="color: #ffffff" id="usernamedrop">user</span>
    </div>
    <i class="fas fa-angle-down styles__profileDropdownIcon___3iLIX-camelCase" aria-hidden="true"></i>
    <div class="styles__profileDropdownMenu___2jUAA-camelCase">
      <a id="logout-link" class="styles__profileDropdownOption___ljZXD-camelCase" href="/login">
  <i class="fas fa-sign-out-alt styles__profileDropdownOptionIcon___15VKX-camelCase" aria-hidden="true"></i>
  Logout
</a>
    </div>
  </div>
</div>

  <div class="styles__sidebar___1XqWi-camelCase">
    <a href="/" id="big-name" class="styles__blooketText___1pMBG-camelCase">Triangulet</a>
    <a class="_button_552gk_1 _bigButton_l4eyq_22" href="/play">
    <div class="_shadow_552gk_11"></div>
    <div class="_edge_552gk_23" style="background-color: #4a7233"></div>
    <div class="_front_552gk_33" style="background-color: #53b721">
        <div class="_bigButtonInside_l4eyq_26"><i class="fas fa-play _bigIcon_l4eyq_39"></i>Play</div>
    </div>
</a>
      <div class="nothin">
        <a class="styles__pageButton___1wFuu-camelCase" href="/market">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-store" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Market</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/trians">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-suitcase" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Trians</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/leaderboard">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-trophy" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Leaderboard</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/chat">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-comment" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Chat</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/posts">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-file" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Posts</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" id="newsbutton" style="cursor: pointer;">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-newspaper" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">News</div>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/auction">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-building-columns" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Auction</div>
          <a class="styles__pageButton___1wFuu-camelCase" href="/trianai"><i class="styles__pageIcon___3OSy9-camelCase fas fa-robot" aria-hidden="true"></i>
            <div class="styles__pageText___1eo7q-camelCase">TrianAI</div>
          </a>
        </a>
        <a class="styles__pageButton___1wFuu-camelCase" href="/staff">
          <i class="styles__pageIcon___3OSy9-camelCase fas fa-terminal" aria-hidden="true"></i>
          <div class="styles__pageText___1eo7q-camelCase">Staff</div>
        </a>
      </div>
    <div class="styles__bottomRow___3OozA-camelCase">
      <a data-tip="Credits" class="styles__smallButton___sQuq8-camelCase" href="/credits" currentitem="false"><i class="styles__bottomIcon___3Fswk-camelCase fas fa-address-book" aria-hidden="true"></i></a>
      <a data-tip="Settings" class="styles__smallButton___sQuq8-camelCase" href="/settings" currentitem="false"><i class="styles__bottomIcon___3Fswk-camelCase fas fa-cogs" aria-hidden="true"></i></a>
      <a data-tip="Stats" class="styles__smallButton___sQuq8-camelCase" href="/stats" currentitem="false"><i class="styles__bottomIcon___3Fswk-camelCase fas fa-user" aria-hidden="true"></i></a>
      <a data-tip="Stats" class="styles__smallButton___sQuq8-camelCase" href="https://discord.gg/FcYy4uHUws" currentitem="false"><i class="styles__bottomIcon___3Fswk-camelCase fab fa-discord" aria-hidden="true"></i></a>
    </div>
  </div>

  <div id="chat-container"></div>

  <div class="styles__infoContainer___2uI-S-camelCase">
    <input type="text" id="user-input" placeholder="Type a message..." />
  </div>

<script>
  function escapeHtml(text) {
    var element = document.createElement('div');
    if (text) {
        element.innerText = text;
        element.textContent = text;
    }
    return element.innerHTML;
  }

  document.addEventListener('DOMContentLoaded', function () {
    const chatContainer = document.getElementById('chat-container');
    const userInput = document.getElementById('user-input');
    let messageHistory = [];

    const username = "User";

    function appendMessage(sender, text) {
      const escapedText = escapeHtml(text);

      if (sender === 'user') {
        chatContainer.innerHTML += `
          <div class="chat-message" style="display: flex; align-items: flex-start; margin-bottom: 15px; gap: 10px;">
            <img src="https://i.ibb.co/7xjgMqBK/user-3297.png" 
                 alt="User Icon" 
                 style="width: 50px; height: 50px; margin-right: 10px; border-radius: 0;">
            <div style="display: flex; flex-direction: column;">
              <strong style="font-size: 1.2em; color: white; margin-bottom: 5px;">User</strong>
              <span style="color: white; font-size: 1em; word-break: break-word; overflow-wrap: break-word;">${escapedText}</span>
            </div>
          </div>`;
      } else if (sender === 'ai') {
        chatContainer.innerHTML += `
          <div class="chat-message" style="display: flex; align-items: flex-start; margin-bottom: 15px; gap: 10px;">
            <img src="https://i.ibb.co/5GBHSTB/Triangulet-Game-Logo.png" 
                 alt="AI Icon" 
                 style="width: 50px; height: 50px; margin-right: 10px; border-radius: 0;">
            <div style="display: flex; flex-direction: column;">
              <strong style="font-size: 1.2em; color: white; margin-bottom: 5px;">TrianAI</strong>
              <span style="color: white; font-size: 1em; word-break: break-word; overflow-wrap: break-word;">${escapedText}</span>
            </div>
          </div>`;
      }
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    async function sendMessage() {
      const userMessage = userInput.value.trim();
      if (userMessage === '') return;

      appendMessage('user', userMessage);
      userInput.value = '';

      messageHistory.push({ role: 'user', content: userMessage });
      if (messageHistory.length > 30) messageHistory.shift();

      try {
        const prompt = messageHistory.map(message => `${message.role === 'user' ? 'User' : 'AI'}: ${message.content}`).join('\n');
        const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}`);

        const rawText = await response.text();
        if (!response.ok) throw new Error('HTTP error! status: ' + response.status);

        const aiResponse = rawText || "Sorry, I couldn't generate a response.";

        messageHistory.push({ role: 'assistant', content: aiResponse });
        if (messageHistory.length > 30) messageHistory.shift();

        appendMessage('ai', aiResponse);
      } catch (error) {
        console.error('Error:', error);
        chatContainer.innerHTML += `<div class="chat-message"><strong>Error:</strong> Failed to get AI response. ${error.message}</div>`;
      }
    }

    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });
  });
</script>
<script src="/news.js"></script> 
  <script src="/themes.js"></script>
  <script src="/all.js"></script>
</body>

</html>
